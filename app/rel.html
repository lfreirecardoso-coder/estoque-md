<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Estoque | Relatórios</title>

  <!-- Favicons -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
  <meta name="theme-color" content="#1a0e0e">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Tema -->
  <link rel="stylesheet" href="theme.css"/>

  <!-- Ajuste visual dos botões no mobile (grade 2x2, iguais) -->
  <style>
    /* bloco de ações */
    .rel-actions{
      display: flex;
      gap: .6rem;
      flex-wrap: wrap;
    }
    .rel-actions .btn{
      border-radius: .8rem;
      font-weight: 600;
      line-height: 1.1;
      padding: .6rem 1rem;
    }
    /* mobile: 2 colunas iguais */
    @media (max-width: 576px){
      .rel-actions{
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: .6rem;
      }
      .rel-actions .btn{
        width: 100%;
        padding: .75rem 0;
        text-align: center;
        font-size: .95rem;
      }
    }

    /* caixas de resultado */
    .box {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1rem;
    }
    .box .box-body {
      min-height: 80px;
      border: 1px dashed rgba(255,255,255,.15);
      border-radius: 10px;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--muted);
    }
  </style>
</head>
<body class="app-body">

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container-fluid">
      <button class="btn-menu d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="offcanvasMenu" aria-label="Abrir menu">
        <span class="hamburger"></span>
      </button>
      <a class="navbar-brand ms-2" href="#">Estoque -MD-</a>
      <div class="ms-auto">
        <button class="btn btn-logout-top" id="btnLogoutTop">Sair</button>
      </div>
    </div>
  </nav>

  <!-- SIDEBAR (desktop) -->
  <aside class="sidebar d-none d-lg-block" id="sidebar">
    <div class="p-3" data-sidebar-content></div>
  </aside>

  <!-- Botão colapso (desktop) -->
  <button class="btn-menu toggle-desktop d-none d-lg-inline-flex" id="toggleDesktop" title="Colapsar/Expandir menu">
    <span class="hamburger"></span>
  </button>

  <!-- OFFCANVAS (mobile) -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasMenuLabel">Menu</h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Fechar"></button>
    </div>
    <div class="offcanvas-body" id="offcanvasMenuBody"><!-- sidebar.js injeta aqui --></div>
  </div>

  <!-- CONTEÚDO -->
  <main class="content">
    <div class="container-fluid">

      <header class="mb-3">
        <h2 class="page-title mb-1">Relatórios</h2>
        <p class="text-muted">
          Gere relatórios por período. Use as datas para escolher no calendário, ou selecione um mês e aplique.
        </p>
      </header>

      <section class="card p-3 mb-3">
        <div class="row g-3">
          <!-- Atalho: mês -->
          <div class="col-12">
            <label class="form-label" for="selAtalho">Atalho: Mês</label>
            <select id="selAtalho" class="form-select">
              <option value="">— Escolha um mês —</option>
              <option value="atual">Mês atual</option>
              <option value="anterior">Mês anterior</option>
              <option value="jan">Janeiro</option>
              <option value="fev">Fevereiro</option>
              <option value="mar">Março</option>
              <option value="abr">Abril</option>
              <option value="mai">Maio</option>
              <option value="jun">Junho</option>
              <option value="jul">Julho</option>
              <option value="ago">Agosto</option>
              <option value="set">Setembro</option>
              <option value="out">Outubro</option>
              <option value="nov">Novembro</option>
              <option value="dez">Dezembro</option>
            </select>
          </div>

          <!-- Datas -->
          <div class="col-12 col-lg-6">
            <label class="form-label" for="dIni">Data (de)</label>
            <input id="dIni" type="date" class="form-control">
          </div>
          <div class="col-12 col-lg-6">
            <label class="form-label" for="dFim">Data (até)</label>
            <input id="dFim" type="date" class="form-control">
          </div>
        </div>

        <!-- Ações -->
        <div class="rel-actions mt-3">
          <button class="btn btn-primary" id="btnRel">Gerar relatório</button>
          <button class="btn btn-ghost"   id="btnCsvResumo">Exportar CSV (Resumo)</button>
          <button class="btn btn-ghost"   id="btnCsvDetalhes">Exportar CSV (Detalhes)</button>
          <button class="btn btn-ghost"   id="btnPdf">Exportar PDF</button>
        </div>
      </section>

      <!-- Resumo por item -->
      <section class="mb-3 box">
        <h5 class="mb-2">Resumo por Item</h5>
        <div class="box-body" id="boxResumo">Escolha o período e clique em “Gerar relatório”.</div>
      </section>

      <!-- Movimentações do período -->
      <section class="mb-3 box">
        <h5 class="mb-2">Movimentações do Período</h5>
        <div class="box-body" id="boxMov">—</div>
      </section>

    </div>
  </main>

  <!-- Firebase + Sidebar + Bootstrap -->
  <script src="firebase.js"></script>
  <script src="sidebar.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Gatilho “Sair” do topo (mantém seu padrão) -->
  <script>
    document.getElementById('btnLogoutTop')?.addEventListener('click', () => {
      if (window.auth && auth.signOut){ auth.signOut().then(()=> location.href='login.html'); }
      else { location.href='login.html'; }
    });
  </script>

  <!-- Aqui continua o SEU JS de relatórios (o que você já tem). 
       Como mantivemos os mesmos IDs (selAtalho, dIni, dFim, btnRel, btnCsvResumo, btnCsvDetalhes, btnPdf, boxResumo, boxMov),
       nada na lógica precisa ser alterado. -->
</body>
</html>
